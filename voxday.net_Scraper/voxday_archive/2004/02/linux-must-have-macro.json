{
  "url": "https://voxday.net/2004/02/01/linux-must-have-macro/",
  "scraped_at": "2025-12-13T15:46:21.351963",
  "title": "Linux: must-have macro",
  "date_display": "February 1, 2004",
  "date_iso": "2004-02-01T00:51:00+00:00",
  "date_from_url": "2004-02-01",
  "author": "VD",
  "content_html": "<div class=\"entry-content\"><p>I got sick and tired of not having the ability to do a word count on a selected portion of text, and I knew there were various macros out there for OpenOffice, so I finally got off my rear and experimented with a few.  The problem, as usual, is that the technoids who graciously donate their time and effort tend not to realize that most of us need things explained from the ground up.  And thatâ€™s ground as in actual ground, terra firma, not somewhere on the third floor.</p><p>Anyhow, if you select Tools / Macro -&gt; Macro from the pull-downs, a confusing window will pop up.  On the left side, click once on Standard so that the macro will show up in all your text documents, then click on the New button on the right side of the window.  A new window will pop up with some Basic in it, just clear it all out and paste in the italicized Basic code below, then save it by selecting File / Save.  To run it, select a piece of text, select Tools / Macro -&gt; Macro, highlight <em>acbwc</em> by clicking once on it, then click Run.  If you want to get fancy, of course, you can just add that macro to a button or whatever.  Itâ€™s fast and it works well, and hopefully will be built into the next version of OpenOffice.  So, a big thanks to the two Andrews, Brown and Pitonyak.</p><p>Once youâ€™ve added the acbwc Word Count macro, hereâ€™s how to add a button to run the macro to the toobar:</p><p>1.  Select Tools/Configure<br> <br>2.  Select Function Bar, then click on the Customize button<br> <br>3.  Click on the + next to OpenOffice.org BASIC Macros<br> <br>4.  Click on the + next to Standard, then again for Module 1<br> <br>5.  Select acbwc, then click on the Addâ€“&gt; button.<br> <br>6.  Select acbwc on the right window, then click the Icons button to give it an icon.  Make sure that the checkbox is checked, or it wonâ€™t show up on the toolbar.</br></br></br></br></br></br></br></br></br></br></p><p><em>Sub acbwc<br> <br>â€˜ v2.0.1<br> <br>â€˜ 5 sept 2003<br> <br>â€˜ does footnotes and selections of all sizes<br> <br>â€˜ still slow with large selections, but I blame Hamburg ğŸ™‚<br> <br>â€˜ v 2.0.1 slightly faster with improved cursorcount routine<br> <br>â€˜ not unendurably slow with lots of footnotes, using cursors.</br></br></br></br></br></br></br></br></br></br></br></br></em></p><p>â€˜ acb, June 2003<br> <br>â€˜ rewritten version of the<br> <br>â€˜ dvwc macro by me and Daniel Vogelheim</br></br></br></br></p><p>â€˜ september 2003 changed the selection count to use a word cursor for large selections<br> <br>â€˜ following hints from Andrew Pitonyak.<br> <br>â€˜ this is not perfect, either, largely because move-by-word is erratic.<br> <br>â€˜ it will slightly exaggerate the number of words in a selection, counting extra<br> <br>â€˜ for paragraph ends and some punctuation.<br> <br>â€˜ but it is still much quicker than the old method.</br></br></br></br></br></br></br></br></br></br></p><p>Dim xDoc, xSel, nSelcount<br> <br>Dim nAllChars<br> <br>Dim nAllWords<br> <br>Dim nAllPars<br> <br>Dim thisrange, sRes<br> <br>Dim nSelChars, nSelwords, nSel<br> <br>Dim atext, bigtext<br> <br>Dim fnotes, thisnote, nfnotes, fnotecount<br> <br>Dim oddthing,startcursor,stopcursor<br> <br> xDoc = thiscomponent<br> <br> xSel = xDoc.getCurrentSelection()<br> <br> nSelCount = xSel.getCount()<br> <br> bigText=xDoc.getText()</br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></p><p> â€˜ by popular demand â€¦<br> <br> fnotes=xdoc.getFootNotes()<br> <br> If fnotes.hasElements() Then<br> <br/> fnotecount=0<br/> <br/> For nfnotes=0 To fnotes.getCount()-1<br/> <br/> thisnote=fnotes.getbyIndex(nfnotes)<br/> <br/> startcursor=thisnote.getStart()<br/> <br/> stopcursor=thisnote.getEnd()<br/> <br/> Do While thisnote.getText().compareRegionStarts(startcursor,stopcursor) AND _<br/> <br/> startcursor.gotoNextWord(FALSE)<br/> <br/> fnotecount=fnotecount+1<br/> <br/> Loop<br/> <br/>â€˜         msgbox(startcursor.getString())<br/> <br/>â€˜         fnotecount=fnotecount+stringcount(thisnote.getstring())<br/> <br/>â€˜         fnotecount=fnotecount+CursorCount(thisnote,bigtext)<br/> <br/> Next nfnotes<br/> <br/> End If</br></br></br></br></br></p><p> â€˜ this next â€œIfâ€ works around the problem that If you have made a selection, then<br/> <br/> â€˜ collapse it, and count again, the empty selection is still counted,<br/> <br/> â€˜ which was confusing and ugly<br/> <br/> If nSelCount=1 and xSel.getByIndex(0).getString()=â€â€ Then<br/> <br/> nSelCount=0<br/> <br/> End If</p><p> â€˜ access document statistics<br/> <br/> nAllChars = xDoc.CharacterCount<br/> <br/> nAllWords = xDoc.WordCount<br/> <br/> nAllPars = xDoc.ParagraphCount</p><p> â€˜ initialize counts<br/> <br/> nSelChars = 0<br/> <br/> nSelWords = 0<br/> <br/> â€˜ the fancy bit starts here<br/> <br/> â€˜ iterate over multiple selection<br/> <br/> For nSel = 0 To nSelCount â€“ 1<br/> <br/> thisrange=xSel.GetByIndex(nSel)<br/> <br/> atext=thisrange.getString()<br/> <br/> If len(atext)&lt; 220 Then\n<br/> nselwords=nSelWords+stringcount(atext)<br/> <br/> Else<br/> <br/> nselwords=nSelWords+Cursorcount(thisrange)<br/> <br/> End If<br/> <br/> nSelChars=nSelChars+len(atext)<br/> <br/> Next nSel</p><p> â€˜ dialog code rewritten for legibility<br/> <br/> If fnotes.hasElements() Then<br/> <br/> sRes=â€Document count (with footnotes): â€  + nAllWords + â€ words. â€  + chr(13)<br/> <br/> sRes= sRes + â€œWord count without footnotes: â€ + str(nAllWords-fnotecount) +_<br/> <br/> â€ words. â€  + chr(13)+â€(Total: â€ +nAllChars +â€ Chars in â€<br/> <br/> Else<br/> <br/> sRes= â€œDocument count: â€  + nAllWords +â€  words. â€  + chr(13)+â€(â€ + _<br/> <br/> nAllChars +â€ Chars in â€<br/> <br/> End If<br/> <br/> sRes=sRes + nAllPars +â€ Paragraphs.)â€+ chr(13)+ chr(13)<br/> <br/> If nselCount&gt;0 Then<br/> <br/> sRes=sRes  + â€œSelected text count: â€ + nSelWords  + â€  wordsâ€ + chr(13) +_<br/> <br/> â€œ(â€ + nSelChars  + â€ charsâ€<br/> <br/> If nSelcount=1 Then<br/> <br/> sRes=sRes  + â€ In â€ + str(nselCount) + â€ selection.)â€<br/> <br/> Else<br/> <br/> REM I donâ€™t know why, but need this adjustment<br/> <br/> sRes=sRes +  â€ In â€ + str(nselCount-1) +â€ selections.)â€<br/> <br/> End If<br/> <br/> sRes=sRes+chr(13)+chr(13)+â€Document minus selected:â€ + chr(13)+_<br/> <br/> str(nAllWords-nSelWords) + â€ words.â€ +chr(13) +chr(13)<br/> <br/> End If<br/> <br/> If fnotes.hasElements() Then<br/> <br/> sRes=sRes+â€There are â€œ+ str(fnotecount) + â€ words in â€œ+ fnotes.getCount() +_<br/> <br/> â€ footnotes.â€ +chr(13) +chr(13)<br/> <br/> End If<br/> <br/> msgbox(sRes,64,â€acb Word Countâ€)<br/> <br/>End Sub</p><p>function Cursorcount(aRange)<br/> <br/>â€˜ acb September 2003<br/> <br/>â€˜ quick count for use with large selections<br/> <br/>â€˜ based on Andrew Pitonyakâ€™s WordCountWordCursor() function<br/> <br/>â€˜ but made cruder, in line with my general tendency.<br/> <br/>Dim lnumwords as long<br/> <br/>Dim atext<br/> <br/>Dim startcursor, stopcursor as object<br/> <br/> atext=arange.getText()<br/> <br/> lnumwords=0<br/> <br/> If not atext.compareRegionStarts(aRange.getStart(),aRange.getEnd()) Then<br/> <br/> startcursor=atext.createTextCursorByRange(aRange.getStart())<br/> <br/> stopcursor=atext.createTextCursorByRange(aRange.getEnd())<br/> <br/> Else<br/> <br/> startcursor=atext.createTextCursorByRange(aRange.getEnd())<br/> <br/> stopcursor=atext.createTextCursorByRange(aRange.getStart())<br/> <br/> End If<br/> <br/> Do while aText.compareRegionEnds(startCursor, stopcursor) &gt;= 0 and _<br/> <br/> startCursor.gotoNextWord(False)<br/> <br/> lnumwords=lnumwords+1<br/> <br/> Loop<br/> <br/> CursorCount=lnumwords-1<br/> <br/>end function</p><p>Function stringcount(astring)<br/> <br/>â€˜ acb June 2003<br/> <br/>â€˜ slower, more accurate word count<br/> <br/>â€˜ for use with smaller strings<br/> <br/>â€˜ sharpened up by David Hammerton (http://crazney.net/) in September 2003<br/> <br/>â€˜ to allow those who put two spaces after punctuation to escape their just deserts<br/> <br/>Dim nspaces,i,testchar,nextchar<br/> <br/> nspaces=0<br/> <br/> For i= 1 To len(astring)-1<br/> <br/> testchar=mid(astring,i,1)<br/> <br/> select Case testchar<br/> <br/> Case â€ â€œ,chr(9),chr(13)<br/> <br/> nextchar = mid(astring,i+1,1)<br/> <br/> select Case nextchar<br/> <br/> Case â€ â€œ,chr(9),chr(13),chr(10)<br/> <br/> nspaces=nspaces<br/> <br/> Case Else<br/> <br/> nspaces=nspaces+1<br/> <br/> end select<br/> <br/> end select<br/> <br/> Next i<br/> <br/> stringcount=nspaces+1<br/> <br/>end function</p></div>",
  "content_text": "I got sick and tired of not having the ability to do a word count on a selected portion of text, and I knew there were various macros out there for OpenOffice, so I finally got off my rear and experimented with a few.  The problem, as usual, is that the technoids who graciously donate their time and effort tend not to realize that most of us need things explained from the ground up.  And thatâ€™s ground as in actual ground, terra firma, not somewhere on the third floor.\nAnyhow, if you select Tools / Macro -> Macro from the pull-downs, a confusing window will pop up.  On the left side, click once on Standard so that the macro will show up in all your text documents, then click on the New button on the right side of the window.  A new window will pop up with some Basic in it, just clear it all out and paste in the italicized Basic code below, then save it by selecting File / Save.  To run it, select a piece of text, select Tools / Macro -> Macro, highlight\nacbwc\nby clicking once on it, then click Run.  If you want to get fancy, of course, you can just add that macro to a button or whatever.  Itâ€™s fast and it works well, and hopefully will be built into the next version of OpenOffice.  So, a big thanks to the two Andrews, Brown and Pitonyak.\nOnce youâ€™ve added the acbwc Word Count macro, hereâ€™s how to add a button to run the macro to the toobar:\n1.  Select Tools/Configure\n2.  Select Function Bar, then click on the Customize button\n3.  Click on the + next to OpenOffice.org BASIC Macros\n4.  Click on the + next to Standard, then again for Module 1\n5.  Select acbwc, then click on the Addâ€“> button.\n6.  Select acbwc on the right window, then click the Icons button to give it an icon.  Make sure that the checkbox is checked, or it wonâ€™t show up on the toolbar.\nSub acbwc\nâ€˜ v2.0.1\nâ€˜ 5 sept 2003\nâ€˜ does footnotes and selections of all sizes\nâ€˜ still slow with large selections, but I blame Hamburg ğŸ™‚\nâ€˜ v 2.0.1 slightly faster with improved cursorcount routine\nâ€˜ not unendurably slow with lots of footnotes, using cursors.\nâ€˜ acb, June 2003\nâ€˜ rewritten version of the\nâ€˜ dvwc macro by me and Daniel Vogelheim\nâ€˜ september 2003 changed the selection count to use a word cursor for large selections\nâ€˜ following hints from Andrew Pitonyak.\nâ€˜ this is not perfect, either, largely because move-by-word is erratic.\nâ€˜ it will slightly exaggerate the number of words in a selection, counting extra\nâ€˜ for paragraph ends and some punctuation.\nâ€˜ but it is still much quicker than the old method.\nDim xDoc, xSel, nSelcount\nDim nAllChars\nDim nAllWords\nDim nAllPars\nDim thisrange, sRes\nDim nSelChars, nSelwords, nSel\nDim atext, bigtext\nDim fnotes, thisnote, nfnotes, fnotecount\nDim oddthing,startcursor,stopcursor\nxDoc = thiscomponent\nxSel = xDoc.getCurrentSelection()\nnSelCount = xSel.getCount()\nbigText=xDoc.getText()\nâ€˜ by popular demand â€¦\nfnotes=xdoc.getFootNotes()\nIf fnotes.hasElements() Then\nfnotecount=0\nFor nfnotes=0 To fnotes.getCount()-1\nthisnote=fnotes.getbyIndex(nfnotes)\nstartcursor=thisnote.getStart()\nstopcursor=thisnote.getEnd()\nDo While thisnote.getText().compareRegionStarts(startcursor,stopcursor) AND _\nstartcursor.gotoNextWord(FALSE)\nfnotecount=fnotecount+1\nLoop\nâ€˜         msgbox(startcursor.getString())\nâ€˜         fnotecount=fnotecount+stringcount(thisnote.getstring())\nâ€˜         fnotecount=fnotecount+CursorCount(thisnote,bigtext)\nNext nfnotes\nEnd If\nâ€˜ this next â€œIfâ€ works around the problem that If you have made a selection, then\nâ€˜ collapse it, and count again, the empty selection is still counted,\nâ€˜ which was confusing and ugly\nIf nSelCount=1 and xSel.getByIndex(0).getString()=â€â€ Then\nnSelCount=0\nEnd If\nâ€˜ access document statistics\nnAllChars = xDoc.CharacterCount\nnAllWords = xDoc.WordCount\nnAllPars = xDoc.ParagraphCount\nâ€˜ initialize counts\nnSelChars = 0\nnSelWords = 0\nâ€˜ the fancy bit starts here\nâ€˜ iterate over multiple selection\nFor nSel = 0 To nSelCount â€“ 1\nthisrange=xSel.GetByIndex(nSel)\natext=thisrange.getString()\nIf len(atext)< 220 Then\nnselwords=nSelWords+stringcount(atext)\nElse\nnselwords=nSelWords+Cursorcount(thisrange)\nEnd If\nnSelChars=nSelChars+len(atext)\nNext nSel\nâ€˜ dialog code rewritten for legibility\nIf fnotes.hasElements() Then\nsRes=â€Document count (with footnotes): â€  + nAllWords + â€ words. â€  + chr(13)\nsRes= sRes + â€œWord count without footnotes: â€ + str(nAllWords-fnotecount) +_\nâ€ words. â€  + chr(13)+â€(Total: â€ +nAllChars +â€ Chars in â€\nElse\nsRes= â€œDocument count: â€  + nAllWords +â€  words. â€  + chr(13)+â€(â€ + _\nnAllChars +â€ Chars in â€\nEnd If\nsRes=sRes + nAllPars +â€ Paragraphs.)â€+ chr(13)+ chr(13)\nIf nselCount>0 Then\nsRes=sRes  + â€œSelected text count: â€ + nSelWords  + â€  wordsâ€ + chr(13) +_\nâ€œ(â€ + nSelChars  + â€ charsâ€\nIf nSelcount=1 Then\nsRes=sRes  + â€ In â€ + str(nselCount) + â€ selection.)â€\nElse\nREM I donâ€™t know why, but need this adjustment\nsRes=sRes +  â€ In â€ + str(nselCount-1) +â€ selections.)â€\nEnd If\nsRes=sRes+chr(13)+chr(13)+â€Document minus selected:â€ + chr(13)+_\nstr(nAllWords-nSelWords) + â€ words.â€ +chr(13) +chr(13)\nEnd If\nIf fnotes.hasElements() Then\nsRes=sRes+â€There are â€œ+ str(fnotecount) + â€ words in â€œ+ fnotes.getCount() +_\nâ€ footnotes.â€ +chr(13) +chr(13)\nEnd If\nmsgbox(sRes,64,â€acb Word Countâ€)\nEnd Sub\nfunction Cursorcount(aRange)\nâ€˜ acb September 2003\nâ€˜ quick count for use with large selections\nâ€˜ based on Andrew Pitonyakâ€™s WordCountWordCursor() function\nâ€˜ but made cruder, in line with my general tendency.\nDim lnumwords as long\nDim atext\nDim startcursor, stopcursor as object\natext=arange.getText()\nlnumwords=0\nIf not atext.compareRegionStarts(aRange.getStart(),aRange.getEnd()) Then\nstartcursor=atext.createTextCursorByRange(aRange.getStart())\nstopcursor=atext.createTextCursorByRange(aRange.getEnd())\nElse\nstartcursor=atext.createTextCursorByRange(aRange.getEnd())\nstopcursor=atext.createTextCursorByRange(aRange.getStart())\nEnd If\nDo while aText.compareRegionEnds(startCursor, stopcursor) >= 0 and _\nstartCursor.gotoNextWord(False)\nlnumwords=lnumwords+1\nLoop\nCursorCount=lnumwords-1\nend function\nFunction stringcount(astring)\nâ€˜ acb June 2003\nâ€˜ slower, more accurate word count\nâ€˜ for use with smaller strings\nâ€˜ sharpened up by David Hammerton (http://crazney.net/) in September 2003\nâ€˜ to allow those who put two spaces after punctuation to escape their just deserts\nDim nspaces,i,testchar,nextchar\nnspaces=0\nFor i= 1 To len(astring)-1\ntestchar=mid(astring,i,1)\nselect Case testchar\nCase â€ â€œ,chr(9),chr(13)\nnextchar = mid(astring,i+1,1)\nselect Case nextchar\nCase â€ â€œ,chr(9),chr(13),chr(10)\nnspaces=nspaces\nCase Else\nnspaces=nspaces+1\nend select\nend select\nNext i\nstringcount=nspaces+1\nend function",
  "tags": [],
  "categories": [],
  "sitemap_lastmod": "2004-02-01T00:51:00+00:00"
}